import pandas as pd
import matplotlib.pyplot as plt
# Đọc file Excel
data=pd.read_excel("D:\\Drug (1).xlsx")

# Lấy cột dữ liệu Condition và chuyển thành kiểu danh sách với điều kiện chỉ lấy 1 dữ liệu duy nhất nếu bị trùng 
conditions=data['Condition'].unique().tolist()

# Tạo danh sách dùng để chứa số lượng thuốc của mỗi loại bệnh
lst_drug=[]

# Duyệt qua từng dữ liệu của danh sách Conditions ( Đi qua từng loại bệnh trong danh sách)
for condition in conditions:
    # Lọc dữ liệu lấy những hàng với điều kiện giống nhau về tên bệnh
    data_new=data.loc[data['Condition']==condition] 

    # Lấy cột dữ liệu Drug trong data vừa lọc ở trên và chuyển thành kiểu danh sách với điều kiện chỉ lấy 1 dữ liệu duy nhất nếu bị trùng 
    drugs=data_new['Drug'].unique().tolist() 
    
    # Đếm số lượng thuốc dùng để chữa bệnh
    count_drug=len(drugs) 

    # Thêm tổng số thuốc dùng để chữa trị bệnh vào danh sách
    lst_drug.append(count_drug)

# In ra danh sách cột Conditions và danh sách số lượng thuốc
print(conditions)
print(lst_drug)

# Vẽ biểu đồ cột với trục ngang là tên các bệnh và trục dọc là số lượng thuốc điều trị bệnh đó
plt.bar(conditions,lst_drug,color='green') 
plt.xticks(rotation=30,ha="right") # Xoay tên của các cột 45 độ theo chiều kim đồng hồ và căn chỉnh các nhãn về phía bên phải 
plt.yticks(range(0,100,5)) # Hiển thị giá trị cột y từ 0 đến 95 và mỗi đơn vị liên tiếp cách nhau 5 
plt.xlabel('Triệu chứng bệnh') # Đặt tên trục x
plt.ylabel('Số lượng thuốc') # đặt tên trục y
plt.title('Tổng số lượng thuốc điều trị của mỗi bệnh') # Đặt tên biểu đồ
plt.subplots_adjust(bottom=0.26) # Dịch chuyển khung biểu đồ lên trên
plt.show() # Hiển thị biểu đồ
