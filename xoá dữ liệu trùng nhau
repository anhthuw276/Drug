import pandas as pd
from openpyxl import load_workbook

# mở file excel (nguồn thông tin)
file_path = 'Drugdbcc.xlsx'       # "Drugdbcc.xlsx" là tên file đã tải về, tức là lúc tải file về thì có phần đặt tên. ở phần code này thì đặt phải trùng tên file đã đặt, phần .xlsx là tệp excel
df = pd.read_excel(file_path)

# Tìm các hàng có cả 4 cột giống hệt nhau
duplicated_rows = df.duplicated(subset=['Reviews', 'Effective', 'EaseOfUse', 'Satisfaction'], keep=False)

# Chỉ giữ lại các hàng không trùng lặp hoàn toàn
df = df[~(duplicated_rows & df.duplicated(subset=['Reviews', 'Effective', 'EaseOfUse', 'Satisfaction'], keep='first'))]

# hiển thị số dòng của file - có hay ko cũng ko sao
print(df)

# đặt tên file, đặt sao cũng được :)
df.to_excel("Drug_cleanedccdb.xlsx", index=False)
