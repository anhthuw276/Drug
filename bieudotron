import pandas as pd 
import matplotlib.pyplot as plt
    
df = pd.read_excel("c:/Users/Admin/Desktop/ĐOANPYTHON/Acute_Bacterial_Sinusitis.xlsx") #đọc file excel
data=df.loc[df['Drug']=='Amoxicillin'] # Lấy những dòng dữ liệu với điều kiện tên thuốc là "Amoxicillin"
a = data['Reviews'].tolist() # a là danh sách giá trị từ cột reviews
b = data['Effective'].tolist() # b là danh sách giá trị từ cột effective 
fig = plt.figure(80x80) # tạo không gian biểu đồ để thêm các trục
# thêm khung biểu đồ vào figure với vị trí ở ngay mép trái 5% khung ở bên dưới sẽ nằm ngoài figure và khung sẽ chiếm toàn bộ figure
ax = fig.add_axes([0,-0.05,1,1]) 
ax.axis('equal') # đảm bảo tỉ lệ 2 trục bằng nhau 
explode = (0,0.2,0.4,0.6,0.8,1) # tưng pie được văng ra tính từ gốc trung tâm 

ax.pie(a,explode=explode,labels=b,autopct='%1.2f%%') # a:giá trị của từng pie , explode: chỉ ra khoảng cách của từng slice , gán nhãn từ cột effective cho mỗi pie , 
# autopct : hiển thị phần trăm trong tuừng pie với 2 chữ số thập phân 
ax.set_title('Biểu đồ thể hiện mức độ đánh giá sự hiệu quả của Amoxicillin',fontsize=14) 
# Hiển thị biểu đồ
plt.show()